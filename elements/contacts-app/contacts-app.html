<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../contact-card/contact-card.html">
<link rel="import" href="../contact-item/contact-item.html">
<link rel="import" href="../contact-page/contact-page.html">

<dom-module id="contacts-app">
  <template>
    <style>
    paper-button { 
      width: 100%;
      display: inline-block;
    }

    paper-input {
      padding: 10px;
      width: calc(100% - 30px);
    }

    paper-header-panel {
      background: #4468AF;
      color: white;
    }

    .header-title {
      margin: 10px;
      display: inline-block;
    }

    .container {
      margin: 5px 20px;
    }

    .toggle-views {
      float: right;
    }

    .main-view {
      float: left;
      width: 70%;
    }

    .secondary-view {
      float: left;
      width: 20%;
    }

    @media (max-width: 768px) {
      .secondary-view {
        display: none;
      }
      .main-view {
        width: 100%;
      }
      .contact-card:{
        padding: 5%;
      };
    }

    </style>
    <iron-ajax
      auto
      url="https://randomuser.me/api/?page={{pageNumber}}&results={{cardsNumber}}&seed=abc"
      last-response="{{users}}"
      handle-as="json">
    </iron-ajax>
    <paper-header-panel mode="waterfall">
      <paper-toolbar>
        <h3 class="header-title"> S|ngular Polymer contacts </h3>
      <paper-toolbar>
    </paper-header-panel>

    <contact-page pageNumber="1"></contact-page>
    <section class="container">
        <section class="mainView">
          <template id="mainView" is="dom-repeat" items="{{users.results}}">
            <contact-card id="contact-card" user="{{item}}"></contact-card>
          </template> 

        </section>
        <aside class="secondary-view">
        
        </aside>
   
    </section>
  </template>
  <script>
    Polymer({
      is: 'contacts-app',
      properties:{
        pageNumber:{
          type: Number,
          value:1
        },
        cardsNumber:{
          type: Number,
          value:10
        },
        users:{
          type:Array
        }

      },
      listeners: {
        "_removeCard":"_removeContact",
        "pageNumber":"_changePage"
      },
      ready: function(){
     
        console.log(this.users);
      },
      _removeContact: function(ev,param){

        console.log(param.user.name.first);
        var index = this.users.results.indexOf(param.user);
        this.users.results.splice(index,1);
        this.$.mainView.render();
      },
      _changePage: function(ev,param){
        console.log(param.pageNumber+1);
        this.pageNumber=param.pageNumber+1;
        this.$.mainView.render();
      }
    })
  </script>
</dom-module>
